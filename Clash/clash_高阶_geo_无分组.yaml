port: 7890
log-level: error
socks-port: 7891
redir-port: 7892
tproxy-port: 7895
mixed-port: 7893
ipv6: true
allow-lan: true
mode: rule
external-controller: 0.0.0.0:9090
secret: nxODt5by
bind-address: "*"
find-process-mode: strict
unified-delay: true
tcp-concurrent: true

keep-alive-interval: 15
keep-alive-idle: 900
geo-update-interval: 168
geodata-mode: true
geo-auto-update: true
geox-url:
  geoip: https://cdn.jsdelivr.net/gh/Loyalsoldier/geoip@release/geoip.dat
  geosite: https://cdn.jsdelivr.net/gh/Loyalsoldier/v2ray-rules-dat@release/geosite.dat
  mmdb: https://cdn.jsdelivr.net/gh/Loyalsoldier/geoip@release/GeoLite2-Country.mmdb
  asn: https://cdn.jsdelivr.net/gh/Loyalsoldier/geoip@release/GeoLite2-ASN.mmdb

dns:
  enable: true
  listen: 127.0.0.1:7874
  ipv6: true
  use-hosts: false
  use-system-hosts: false
  default-nameserver:
    - 223.5.5.5
    - 223.6.6.6
    - 119.29.29.29
  nameserver:
    - https://cloudflare-dns.com/dns-query
    - https://dns.google/dns-query
  proxy-server-nameserver:
    - https://dns.alidns.com/dns-query
    - https://doh.pub/dns-query
  direct-nameserver:
    - https://dns.alidns.com/dns-query
    - https://doh.pub/dns-query
    - https://223.5.5.5/dns-query
    - https://223.6.6.6/dns-query#h3=true
  respect-rules: true
  nameserver-policy: {}
  enhanced-mode: redir-host
  fake-ip-range: 198.18.0.1/16
  fake-ip-filter-mode: blacklist
  fake-ip-filter:
    - "*.lan"
    - stun.*.*.*
    - stun.*.*
    - music.163.com
    - "*.music.163.com"
    - "*.126.net"
    - musicapi.taihe.com
    - music.taihe.com
    - songsearch.kugou.com
    - trackercdn.kugou.com
    - "*.kuwo.cn"
    - api-jooxtt.sanook.com
    - api.joox.com
    - joox.com
    - y.qq.com
    - "*.y.qq.com"
    - streamoc.music.tc.qq.com
    - mobileoc.music.tc.qq.com
    - isure.stream.qqmusic.qq.com
    - dl.stream.qqmusic.qq.com
    - aqqmusic.tc.qq.com
    - amobile.music.tc.qq.com
    - "*.xiami.com"
    - "*.music.migu.cn"
    - music.migu.cn
    - "*.msftconnecttest.com"
    - "*.msftncsi.com"
    - localhost.ptlogin2.qq.com
    - "*.*.*.srv.nintendo.net"
    - "*.*.stun.playstation.net"
    - xbox.*.*.microsoft.com
    - "*.ipv6.microsoft.com"
    - "*.*.xboxlive.com"
    - speedtest.cros.wr.pvp.net
    - geosite:category-ntp
  prefer-h3: false
tun:
  enable: true
  stack: mixed
  device: utun
  strict-route: true
  auto-route: true
  auto-detect-interface: true
  dns-hijack:
    - tcp://any:53
hosts:
  #'engage.cloudflareclient.com': 192.168.0.1

profile:
  store-selected: true
  store-fake-ip: true

authentication:
  - ZOYO:9kos01P

# ===================== æ ¸å¿ƒä¿®æ­£ï¼šé”šç‚¹å®šä¹‰ï¼ˆä¸¥æ ¼ç¬¦åˆ YAML è§„èŒƒï¼‰ =====================
# 1. åˆ†ç»„é€šç”¨é”šç‚¹ï¼ˆ&prï¼‰ï¼šå®šä¹‰ select ç±»å‹åˆ†ç»„çš„é€šç”¨ç»“æ„
pr: &pr
  type: select
  proxies:
    - DIRECT
    - REJECT
    - â™»ï¸ è‡ªåŠ¨é€‰æ‹©
    - âœ‹ğŸ» æ‰‹åŠ¨é€‰æ‹©

# 2. è§„åˆ™è®¢é˜…é”šç‚¹ï¼ˆ&rpï¼‰ï¼šrule-providers é€šç”¨ç»“æ„
rp: &rp
  type: http
  behavior: classical
  interval: 86400

# 3. Provider é€šç”¨é”šç‚¹ï¼ˆ&pï¼‰ï¼šproxy-providers é€šç”¨å¥åº·æ£€æŸ¥ç»“æ„
p: &p
  type: http
  interval: 3600
  health-check:
    enable: true
    url: http://www.apple.com/library/test/success.html
    interval: 300

# æ–°å¢ï¼š url-test é€šç”¨é…ç½®ä¸ºç‹¬ç«‹é”šç‚¹ âœ¨
url-test: &url-test
  type: url-test
  url: http://cp.cloudflare.com/generate_204
  interval: 900
  lazy: true
  timeout: 3000
  max-failed-times: 3
  icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Want_Want.png

# 4. Local/CF Provider å¼•ç”¨é”šç‚¹ï¼ˆå…³é”®ä¿®æ­£ï¼šé”šç‚¹æŒ‡å‘åˆæ³•çš„ use åˆ—è¡¨ï¼‰
# é”šç‚¹ &Localï¼šæŒ‡å‘ ["Local"]ï¼ˆClash Premium ä¸­ use å­—æ®µç”¨äºå¼•ç”¨ proxy-providersï¼‰
Local: &Local
  use:
    - Local  # å¯¹åº” proxy-providers ä¸­çš„ Local æº
  type: select

CF: &CF
  use:
    - CF  # å¯¹åº” proxy-providers ä¸­çš„ CF æº
  <<: *url-test

# ===================== proxy-providersï¼ˆæ— é”™è¯¯ï¼Œä»…æ ¼å¼åŒ–ï¼‰ =====================
proxy-providers:
  Local:
    <<: *p  # åˆå¹¶ Provider é€šç”¨é”šç‚¹
    url: "æœ¬åœ°è®¢é˜…è¿æ¥1"
    path: "./proxy_provider/Local.yaml"
  CF:
    <<: *p  # åˆå¹¶ Provider é€šç”¨é”šç‚¹
    url: "è¿œç«¯è®¢é˜…è¿æ¥2"
    path: "./proxy_provider/cf.yaml"

# ===================== proxy-groupsï¼ˆæ ¸å¿ƒä¿®æ­£ï¼šé”šç‚¹å¼•ç”¨+å­—æ®µç±»å‹ï¼‰ =====================
proxy-groups:
  # æ‰‹åŠ¨é€‰æ‹©ï¼šåˆå¹¶ &Local é”šç‚¹ï¼ˆuse: [Local] + type: selectï¼‰
  - name: âœ‹ğŸ» æ‰‹åŠ¨é€‰æ‹©
    <<: *Local  # åˆå¹¶ Local é”šç‚¹çš„ use/type

  # è‡ªåŠ¨é€‰æ‹©ï¼šåˆå¹¶ &CF é”šç‚¹ + è¡¥å…… url-test ä¸“å±å­—æ®µ + ä¿®æ­£ interval ç±»å‹
  - name: â™»ï¸ è‡ªåŠ¨é€‰æ‹©
    <<: *CF  # åˆå¹¶ CF é”šç‚¹çš„ use/type

  # å…¶ä»–åˆ†ç»„ï¼ˆæ— é”™è¯¯ï¼Œä»…æ ¼å¼åŒ–ï¼‰
  - name: å¹¿å‘Šæ‹¦æˆª
    <<: *pr
    icon: "https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Advertising.png"

  - name: è¿è¥åŠ«æŒ
    <<: *pr
    icon: "https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Hijacking.png"

  - name: AI
    <<: *pr
    icon: "https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Bot.png"

  - name: TikTok
    <<: *pr
    icon: "https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/TikTok.png"

  - name: Discord
    <<: *pr
    icon: "https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Magic.png"

  - name: è‹¹æœæœåŠ¡
    <<: *pr
    icon: "https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Apple.png"

  - name: å›½å¤–æœåŠ¡
    <<: *pr
    icon: "https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Google_Search.png"

  - name: å›½å†…æœåŠ¡
    <<: *pr
    icon: "https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/China_Map.png"

  - name: æ¼ç½‘ä¹‹é±¼
    <<: *pr
    icon: "https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Final.png"

# ===================== rules + rule-providersï¼ˆæ— é”™è¯¯ï¼Œä»…æ ¼å¼åŒ–ï¼‰ =====================
rules:
  - RULE-SET,Direct,å›½å†…æœåŠ¡
  - RULE-SET,Advertising,å¹¿å‘Šæ‹¦æˆª
  - IP-CIDR,1.1.1.1/32,å›½å¤–æœåŠ¡
  - RULE-SET,è¿è¥å•†åŠ«æŒ,è¿è¥åŠ«æŒ
  - RULE-SET,AI,AI
  - GEOSITE,anthropic,AI
  - GEOSITE,tiktok,TikTok
  - GEOSITE,openai,AI
  - GEOSITE,discord,Discord
  - GEOSITE,github,å›½å¤–æœåŠ¡
  - GEOSITE,twitter,å›½å¤–æœåŠ¡
  - GEOSITE,youtube,å›½å¤–æœåŠ¡
  - GEOSITE,facebook,å›½å¤–æœåŠ¡
  - GEOSITE,google,å›½å¤–æœåŠ¡
  - GEOSITE,telegram,å›½å¤–æœåŠ¡
  - GEOSITE,bilibili,å›½å†…æœåŠ¡
  - GEOSITE,apple-cn,è‹¹æœæœåŠ¡
  - GEOSITE,CN,å›½å†…æœåŠ¡
  - GEOSITE,geolocation-!cn,å›½å¤–æœåŠ¡
  - GEOIP,cloudflare,å›½å¤–æœåŠ¡
  - GEOIP,cloudfront,å›½å¤–æœåŠ¡
  - GEOIP,google,å›½å¤–æœåŠ¡
  - GEOIP,telegram,å›½å¤–æœåŠ¡
  - GEOIP,twitter,å›½å¤–æœåŠ¡
  - GEOIP,CN,å›½å†…æœåŠ¡
  - MATCH,æ¼ç½‘ä¹‹é±¼

rule-providers:
  Direct:
    <<: *rp
    path: "./rule_provider/Direct.yaml"
    url: "https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Direct/Direct.yaml"

  Advertising:
    <<: *rp
    path: "./rule_provider/Advertising.yaml"
    url: "https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Advertising/Advertising.yaml"

  è¿è¥å•†åŠ«æŒ:
    <<: *rp
    path: "./rule_provider/è¿è¥å•†åŠ«æŒ.yaml"
    url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Hijacking/Hijacking.yaml"

  AI:
    <<: *rp
    path: "./rule_provider/AI.txt"
    format: text
    url: https://ruleset.skk.moe/Clash/non_ip/ai.txt
